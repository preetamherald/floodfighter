AFRAME.registerComponent("travel-node",{schema:{axis:{type:"string","default":null},offsetX:{type:"number","default":null},offsetY:{type:"number","default":null},offsetZ:{type:"number","default":null},transition:{type:"string","default":null},animationDur:{type:"number","default":null},animationEasing:{type:"number","default":null},travelTarget:{type:"selector"}},axises:null,clickEventRegistered:!1,travelTarget:null,update:function(){var t=document.querySelector("a-scene");t.hasLoaded?this.setupVariables():t.addEventListener("loaded",function(){this.setupVariables()}.bind(this))},setupVariables:function(){var t=document.querySelector("a-scene"),e=t.components["travel-node-defaults"];if(void 0===e)return t.setAttribute("travel-node-defaults",""),void setTimeout(this.setupVariables.bind(this),10);for(var a in this.data)("number"===this.schema[a].type&&isNaN(this.data[a])||null===this.data[a])&&(this.data[a]=e.data[a]);this.axises={};var i=this.data.axis.toLowerCase().split(","),n=["x","y","z"];for(var a in n){var r=n[a];i.indexOf(r)>=0&&(this.axises[r]=!0)}this.travelTarget=this.data.travelTarget,null===this.travelTarget&&console.warn("Can't determine travel target."),this.clickEventRegistered||(this.el.addEventListener("click",this.onClick.bind(this)),this.clickEventRegistered=!0)},onClick:function(){var t=new THREE.Vector3,e=new THREE.Vector3;t.setFromMatrixPosition(this.el.object3D.matrixWorld),e.setFromMatrixPosition(this.travelTarget.object3D.matrixWorld);for(var a in this.axises)e[a]=t[a];switch(e.x+=this.data.offsetX,e.y+=this.data.offsetY,e.z+=this.data.offsetZ,this.targetPosition=e,this.data.transition){case"fade":this.fadeToTarget();break;case"move":AFRAME.components.animation?this.moveToTarget():(console.warn("To use the 'move' transition, you will need to add the aframe-animation-component component, available at https://github.com/ngokevin/aframe-animation-component"),this.jumpToTarget());break;default:console.warn("Unknown travel mode: "+this.data.mode);case"jump":this.jumpToTarget()}},fadeToTarget:function(){var t=document.querySelector("a-scene"),e=t.camera.el,a=document.createElement("a-plane");a.setAttribute("position","0 0 -0.1"),a.setAttribute("material","color: black; transparent: true; opacity: 0");var i=document.createElement("a-animation");i.setAttribute("attribute","material.opacity"),i.setAttribute("from","0"),i.setAttribute("to","1"),i.setAttribute("dur",this.data.animationDur),i.setAttribute("easing",this.data.animationEasing);var n=i.cloneNode(!0);n.setAttribute("from","1"),n.setAttribute("to","0"),n.setAttribute("delay",this.data.animationDur+100),i.addEventListener("animationend",function(){this.jumpToTarget()}.bind(this)),n.addEventListener("animationend",function(){a.removeChild(n),a.removeChild(i),e.removeChild(a)}),a.appendChild(n),a.appendChild(i),e.appendChild(a)},moveToTarget:function(){var t="property: position; to: "+this.targetPosition.x+" "+this.targetPosition.y+" "+this.targetPosition.z+"; dur: "+this.data.animationDur+"; easing: "+this.data.animationEasing;this.travelTarget.setAttribute("animation__travel-node_movetotarget",t),this.travelTarget.addEventListener("animation__travel-node_movetotarget-complete",function(){this.travelTarget.removeAttribute("animation__travel-node_movetotarget")}.bind(this))},jumpToTarget:function(){this.travelTarget.setAttribute("position",this.targetPosition)}}),AFRAME.registerComponent("travel-node-defaults",{schema:{axis:{type:"string","default":"x,z"},offsetX:{type:"number","default":0},offsetY:{type:"number","default":0},offsetZ:{type:"number","default":0},transition:{type:"string","default":"fade"},animationDur:{type:"number","default":100},animationEasing:{type:"string","default":"linear"},travelTarget:{type:"selector","default":"[camera]"}},init:function(){var t=document.querySelector("a-scene");t.hasLoaded?this.checkElement():t.addEventListener("loaded",function(){this.checkElement()}.bind(this))},checkElement:function(){"A-SCENE"!==this.el.tagName&&console.warn("travel-node-defaults should be placed on the a-scene element.")}});